# Birthday Section Enhancements Design

## Overview

Enhance family profile birthday sections with zodiac signs and rotating fun facts (famous birthdays, historical events, trivia).

## Requirements

- **Zodiac**: Sign + symbol + brief trait (e.g., "Gemini â™Š - Curious & adaptable")
- **Fun facts**: Mix of famous birthdays, historical events, and trivia (National Pizza Day, etc.)
- **Rotation**: Random fact on each page load
- **Data**: 15+ facts per date, pre-generated by Claude
- **Refresh**: Monthly via GitHub Action

## Architecture

### Zodiac Signs

**File:** `lib/zodiac.ts`

Static utility with date ranges and traits:

```typescript
interface ZodiacInfo {
  sign: string;
  symbol: string;
  trait: string;
}

function getZodiacSign(month: number, day: number): ZodiacInfo
```

No API calls - pure date math.

### Birthday Facts

**Data file:** `public/data/birthday-facts.json`

```json
{
  "01-01": [
    { "type": "birthday", "year": 1735, "text": "Paul Revere, American patriot" },
    { "type": "event", "year": 1953, "text": "First Rose Bowl Game" },
    { "type": "trivia", "text": "National Hangover Day" }
  ]
}
```

- Keys: `MM-DD` format (366 entries including Feb 29)
- 15+ facts per date across three types
- ~80KB file size, cached by browser

**Utility:** `lib/birthday-facts.ts`

```typescript
interface BirthdayFact {
  type: 'birthday' | 'event' | 'trivia';
  year?: number;
  text: string;
}

function getRandomFact(month: number, day: number): BirthdayFact | null
```

### Display

Birthday card shows (in order):
1. Formatted date: "Tuesday, June 2, 2015"
2. Zodiac: "â™Š Gemini - Curious & adaptable"
3. Fun fact with type-specific prefix:
   - Birthday: "ðŸŽ‚ Born today: Charlie Watts, Rolling Stones drummer (1941)"
   - Event: "ðŸ“… On this day: Queen Elizabeth II crowned (1953)"
   - Trivia: "ðŸŽ‰ Fun fact: It's National Rocky Road Day!"
4. Countdown: "ðŸŽˆ 136 days away"

### Generation Script

**File:** `scripts/generate-birthday-facts.ts`

- Run locally: `npx tsx scripts/generate-birthday-facts.ts`
- Calls Claude API (Haiku model for cost efficiency)
- Batches 10 dates per API call (~37 total calls)
- Outputs to `public/data/birthday-facts.json`
- Estimated cost: ~$0.50 per full regeneration

### Monthly Refresh

**GitHub Action:** `.github/workflows/refresh-birthday-facts.yml`

```yaml
name: Refresh Birthday Facts
on:
  schedule:
    - cron: '0 0 1 * *'  # 1st of each month at midnight
  workflow_dispatch:  # Manual trigger

jobs:
  refresh:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
      - run: npm ci
      - run: npx tsx scripts/generate-birthday-facts.ts
        env:
          CLAUDE_API_KEY: ${{ secrets.CLAUDE_API_KEY }}
      - uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "chore: refresh birthday facts [automated]"
```

Vercel auto-deploys on commit, so fresh facts go live automatically.

## Files to Create/Modify

**New files:**
- `lib/zodiac.ts` - Zodiac sign utility
- `lib/birthday-facts.ts` - Fact loading/selection utility
- `public/data/birthday-facts.json` - Pre-generated facts (366 dates Ã— 15+ facts)
- `scripts/generate-birthday-facts.ts` - Claude-powered generation script
- `.github/workflows/refresh-birthday-facts.yml` - Monthly refresh action

**Modified files:**
- `app/family/[name]/page.tsx` - Enhanced birthday card display

## Cost & Performance

- **Generation**: ~$0.50/month (Claude Haiku)
- **Runtime**: Zero API calls - static JSON fetch
- **File size**: ~80KB, cached by browser
- **Load time**: Negligible impact

## Testing

1. Run generation script locally, verify JSON structure
2. Check zodiac accuracy for edge dates (cusp days)
3. Verify random selection produces variety
4. Test birthday card display at all states (today, tomorrow, future)
5. Trigger GitHub Action manually to verify workflow
