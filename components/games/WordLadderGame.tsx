"use client";

import { useState, useEffect, useCallback } from "react";
import { Card } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { RefreshCw, Trophy, Settings, ArrowDown } from "lucide-react";
import {
  getRandomWordLadderPuzzle,
  differsByOneLetter,
  type WordLadderPuzzle,
} from "@/lib/word-ladder-puzzles";
import { type Difficulty } from "@/lib/game-words";
import { isValidWord as isValid5LetterWord } from "@/lib/valid-words";

interface WordLadderGameProps {
  difficulty?: Difficulty;
  onChangeDifficulty?: () => void;
}

// Valid 3-letter words for easy difficulty
const VALID_THREE_LETTER_WORDS: Set<string> = new Set([
  "ACE",
  "ACT",
  "ADD",
  "AGE",
  "AGO",
  "AID",
  "AIM",
  "AIR",
  "ALL",
  "AND",
  "ANT",
  "ANY",
  "APE",
  "ARC",
  "ARE",
  "ARK",
  "ARM",
  "ART",
  "ASH",
  "ATE",
  "AWE",
  "AXE",
  "BAD",
  "BAG",
  "BAN",
  "BAR",
  "BAT",
  "BAY",
  "BED",
  "BEE",
  "BET",
  "BIG",
  "BIN",
  "BIT",
  "BOW",
  "BOX",
  "BOY",
  "BUD",
  "BUG",
  "BUN",
  "BUS",
  "BUT",
  "BUY",
  "CAB",
  "CAN",
  "CAP",
  "CAR",
  "CAT",
  "COB",
  "COD",
  "COG",
  "COP",
  "COT",
  "COW",
  "CRY",
  "CUB",
  "CUD",
  "CUP",
  "CUR",
  "CUT",
  "DAB",
  "DAD",
  "DAM",
  "DAY",
  "DEN",
  "DEW",
  "DID",
  "DIG",
  "DIM",
  "DIP",
  "DOC",
  "DOE",
  "DOG",
  "DOT",
  "DRY",
  "DUB",
  "DUD",
  "DUE",
  "DUG",
  "DYE",
  "EAR",
  "EAT",
  "EEL",
  "EGG",
  "ELF",
  "ELK",
  "ELM",
  "EMU",
  "END",
  "ERA",
  "EVE",
  "EWE",
  "EYE",
  "FAN",
  "FAR",
  "FAT",
  "FAX",
  "FED",
  "FEE",
  "FEN",
  "FEW",
  "FIG",
  "FIN",
  "FIR",
  "FIT",
  "FIX",
  "FLY",
  "FOB",
  "FOE",
  "FOG",
  "FOP",
  "FOR",
  "FOX",
  "FRY",
  "FUN",
  "FUR",
  "GAB",
  "GAG",
  "GAL",
  "GAP",
  "GAS",
  "GAY",
  "GEL",
  "GEM",
  "GET",
  "GIG",
  "GIN",
  "GNU",
  "GOB",
  "GOD",
  "GOT",
  "GUM",
  "GUN",
  "GUT",
  "GUY",
  "GYM",
  "HAD",
  "HAM",
  "HAS",
  "HAT",
  "HAY",
  "HEM",
  "HEN",
  "HER",
  "HEW",
  "HEX",
  "HID",
  "HIM",
  "HIP",
  "HIS",
  "HIT",
  "HOB",
  "HOD",
  "HOG",
  "HOP",
  "HOT",
  "HOW",
  "HUB",
  "HUE",
  "HUG",
  "HUM",
  "HUT",
  "ICE",
  "ICY",
  "ILL",
  "IMP",
  "INK",
  "INN",
  "ION",
  "IRE",
  "IRK",
  "ITS",
  "IVY",
  "JAB",
  "JAG",
  "JAM",
  "JAR",
  "JAW",
  "JAY",
  "JET",
  "JIG",
  "JOB",
  "JOG",
  "JOT",
  "JOY",
  "JUG",
  "JUT",
  "KEG",
  "KEN",
  "KEY",
  "KID",
  "KIN",
  "KIT",
  "LAB",
  "LAC",
  "LAD",
  "LAG",
  "LAP",
  "LAW",
  "LAX",
  "LAY",
  "LEA",
  "LED",
  "LEG",
  "LET",
  "LID",
  "LIE",
  "LIP",
  "LIT",
  "LOG",
  "LOT",
  "LOW",
  "LUG",
  "MAD",
  "MAN",
  "MAP",
  "MAR",
  "MAT",
  "MAW",
  "MAX",
  "MAY",
  "MEN",
  "MET",
  "MID",
  "MIX",
  "MOB",
  "MOD",
  "MOM",
  "MOP",
  "MOW",
  "MUD",
  "MUG",
  "MUM",
  "NAB",
  "NAG",
  "NAP",
  "NAY",
  "NET",
  "NEW",
  "NIL",
  "NIP",
  "NIT",
  "NOB",
  "NOD",
  "NOR",
  "NOT",
  "NOW",
  "NUB",
  "NUN",
  "NUT",
  "OAK",
  "OAR",
  "OAT",
  "ODD",
  "ODE",
  "OFF",
  "OFT",
  "OHM",
  "OIL",
  "OLD",
  "ONE",
  "OPT",
  "ORB",
  "ORE",
  "OUR",
  "OUT",
  "OWE",
  "OWL",
  "OWN",
  "PAD",
  "PAL",
  "PAN",
  "PAP",
  "PAR",
  "PAT",
  "PAW",
  "PAY",
  "PEA",
  "PEG",
  "PEN",
  "PEP",
  "PER",
  "PET",
  "PEW",
  "PIE",
  "PIG",
  "PIN",
  "PIT",
  "PLY",
  "POD",
  "POP",
  "POT",
  "POW",
  "PRY",
  "PUB",
  "PUN",
  "PUP",
  "PUS",
  "PUT",
  "RAG",
  "RAM",
  "RAN",
  "RAP",
  "RAT",
  "RAW",
  "RAY",
  "RED",
  "REF",
  "REP",
  "RIB",
  "RID",
  "RIG",
  "RIM",
  "RIP",
  "ROB",
  "ROD",
  "ROE",
  "ROT",
  "ROW",
  "RUB",
  "RUG",
  "RUM",
  "RUN",
  "RUT",
  "RYE",
  "SAC",
  "SAD",
  "SAG",
  "SAP",
  "SAT",
  "SAW",
  "SAY",
  "SEA",
  "SET",
  "SEW",
  "SHE",
  "SHY",
  "SIN",
  "SIP",
  "SIR",
  "SIS",
  "SIT",
  "SIX",
  "SKI",
  "SKY",
  "SLY",
  "SOB",
  "SOD",
  "SON",
  "SOP",
  "SOT",
  "SOW",
  "SOY",
  "SPA",
  "SPY",
  "STY",
  "SUB",
  "SUM",
  "SUN",
  "SUP",
  "TAB",
  "TAD",
  "TAG",
  "TAN",
  "TAP",
  "TAR",
  "TAT",
  "TAX",
  "TEA",
  "TEN",
  "THE",
  "THY",
  "TIC",
  "TIE",
  "TIN",
  "TIP",
  "TOE",
  "TON",
  "TOO",
  "TOP",
  "TOT",
  "TOW",
  "TOY",
  "TRY",
  "TUB",
  "TUG",
  "TUN",
  "TWO",
  "URN",
  "USE",
  "VAN",
  "VAT",
  "VET",
  "VIA",
  "VIE",
  "VOW",
  "WAD",
  "WAG",
  "WAR",
  "WAS",
  "WAX",
  "WAY",
  "WEB",
  "WED",
  "WEE",
  "WET",
  "WHO",
  "WHY",
  "WIG",
  "WIN",
  "WIT",
  "WOE",
  "WOK",
  "WON",
  "WOO",
  "WOW",
  "YAK",
  "YAM",
  "YAP",
  "YAW",
  "YEA",
  "YES",
  "YET",
  "YEW",
  "YIN",
  "YIP",
  "YOU",
  "ZAP",
  "ZED",
  "ZEN",
  "ZIP",
  "ZIT",
  "ZOO",
]);

// Valid 4-letter words for medium difficulty
const VALID_FOUR_LETTER_WORDS: Set<string> = new Set([
  "ABLE",
  "ACHE",
  "ACID",
  "AGED",
  "AIDE",
  "AIDS",
  "AIMS",
  "AIRS",
  "AIRY",
  "AJAR",
  "AKIN",
  "ALLY",
  "ALSO",
  "AMID",
  "ANTS",
  "APES",
  "APEX",
  "ARCH",
  "AREA",
  "ARIA",
  "ARMS",
  "ARMY",
  "ARTS",
  "ASKS",
  "AUTO",
  "AXIS",
  "BABY",
  "BACK",
  "BAGS",
  "BAIL",
  "BAIT",
  "BAKE",
  "BALD",
  "BALE",
  "BALL",
  "BALM",
  "BAND",
  "BANE",
  "BANG",
  "BANK",
  "BANS",
  "BARE",
  "BARK",
  "BARN",
  "BARS",
  "BASE",
  "BASH",
  "BASS",
  "BATH",
  "BATS",
  "BAYS",
  "BEAD",
  "BEAK",
  "BEAM",
  "BEAN",
  "BEAR",
  "BEAT",
  "BEDS",
  "BEEF",
  "BEEN",
  "BEER",
  "BEES",
  "BEET",
  "BELL",
  "BELT",
  "BEND",
  "BENT",
  "BERG",
  "BEST",
  "BETS",
  "BIAS",
  "BIDS",
  "BIKE",
  "BILE",
  "BILL",
  "BIND",
  "BINS",
  "BIRD",
  "BITE",
  "BITS",
  "BLOW",
  "BLUE",
  "BLUR",
  "BOAR",
  "BOAT",
  "BODE",
  "BODY",
  "BOIL",
  "BOLD",
  "BOLT",
  "BOMB",
  "BOND",
  "BONE",
  "BOOK",
  "BOOM",
  "BOON",
  "BOOT",
  "BORE",
  "BORN",
  "BOSS",
  "BOTH",
  "BOUT",
  "BOWL",
  "BOWS",
  "BOYS",
  "BRAG",
  "BRAN",
  "BRAT",
  "BRED",
  "BREW",
  "BRIM",
  "BROW",
  "BUCK",
  "BUDS",
  "BUGS",
  "BULK",
  "BULL",
  "BUMP",
  "BUNK",
  "BURN",
  "BURY",
  "BUSH",
  "BUST",
  "BUSY",
  "BUYS",
  "BUZZ",
  "CAFE",
  "CAGE",
  "CAKE",
  "CALF",
  "CALL",
  "CALM",
  "CAME",
  "CAMP",
  "CANE",
  "CAPE",
  "CAPS",
  "CARD",
  "CARE",
  "CARP",
  "CARS",
  "CART",
  "CASE",
  "CASH",
  "CASK",
  "CAST",
  "CATS",
  "CAVE",
  "CELL",
  "CENT",
  "CHAP",
  "CHAR",
  "CHAT",
  "CHEF",
  "CHEW",
  "CHIN",
  "CHIP",
  "CHOP",
  "CITY",
  "CLAD",
  "CLAM",
  "CLAN",
  "CLAP",
  "CLAW",
  "CLAY",
  "CLIP",
  "CLOD",
  "CLOG",
  "CLUB",
  "CLUE",
  "COAL",
  "COAT",
  "COCK",
  "CODE",
  "COIL",
  "COIN",
  "COKE",
  "COLD",
  "COLT",
  "COMB",
  "COME",
  "CONE",
  "COOK",
  "COOL",
  "COPE",
  "COPY",
  "CORD",
  "CORE",
  "CORK",
  "CORN",
  "COST",
  "COSY",
  "COUP",
  "COVE",
  "CRAB",
  "CRAM",
  "CREW",
  "CRIB",
  "CROP",
  "CROW",
  "CUBE",
  "CUBS",
  "CUFF",
  "CULT",
  "CUPS",
  "CURB",
  "CURE",
  "CURL",
  "CUTE",
  "CUTS",
  "DAFT",
  "DALE",
  "DAME",
  "DAMP",
  "DAMS",
  "DANK",
  "DARE",
  "DARK",
  "DARN",
  "DART",
  "DASH",
  "DATA",
  "DATE",
  "DAWN",
  "DAYS",
  "DAZE",
  "DEAD",
  "DEAF",
  "DEAL",
  "DEAN",
  "DEAR",
  "DEBT",
  "DECK",
  "DEED",
  "DEEM",
  "DEEP",
  "DEER",
  "DEMO",
  "DENT",
  "DENY",
  "DESK",
  "DIAL",
  "DICE",
  "DIED",
  "DIES",
  "DIET",
  "DIGS",
  "DIME",
  "DINE",
  "DIRE",
  "DIRT",
  "DISC",
  "DISH",
  "DISK",
  "DIVE",
  "DOCK",
  "DOES",
  "DOGS",
  "DOLE",
  "DOLL",
  "DOME",
  "DONE",
  "DOOM",
  "DOOR",
  "DOSE",
  "DOTS",
  "DOTE",
  "DOVE",
  "DOWN",
  "DOZE",
  "DRAB",
  "DRAG",
  "DRAM",
  "DRAT",
  "DRAW",
  "DREW",
  "DRIP",
  "DROP",
  "DRUG",
  "DRUM",
  "DUAL",
  "DUBS",
  "DUCK",
  "DUCT",
  "DUDE",
  "DUDS",
  "DUEL",
  "DUES",
  "DUET",
  "DUKE",
  "DULL",
  "DULY",
  "DUMB",
  "DUMP",
  "DUNE",
  "DUNG",
  "DUNK",
  "DUSK",
  "DUST",
  "DUTY",
  "EACH",
  "EARL",
  "EARN",
  "EARS",
  "EASE",
  "EAST",
  "EASY",
  "EATS",
  "EAVE",
  "ECHO",
  "EDGE",
  "EDGY",
  "EDIT",
  "EELS",
  "EGGS",
  "ELSE",
  "EMIT",
  "ENDS",
  "ENVY",
  "EPIC",
  "EVEN",
  "EVER",
  "EVIL",
  "EXAM",
  "EXEC",
  "EXIT",
  "EXPO",
  "EYES",
  "FACE",
  "FACT",
  "FADE",
  "FAIL",
  "FAIR",
  "FAKE",
  "FALL",
  "FAME",
  "FANG",
  "FANS",
  "FARE",
  "FARM",
  "FAST",
  "FATE",
  "FAWN",
  "FEAR",
  "FEAT",
  "FEED",
  "FEEL",
  "FEES",
  "FEET",
  "FELL",
  "FELT",
  "FEND",
  "FERN",
  "FEST",
  "FEUD",
  "FILE",
  "FILL",
  "FILM",
  "FIND",
  "FINE",
  "FIRE",
  "FIRM",
  "FISH",
  "FIST",
  "FITS",
  "FIVE",
  "FLAG",
  "FLAK",
  "FLAM",
  "FLAP",
  "FLAT",
  "FLAW",
  "FLAX",
  "FLAY",
  "FLEA",
  "FLED",
  "FLEE",
  "FLEW",
  "FLEX",
  "FLIP",
  "FLIT",
  "FLOG",
  "FLOP",
  "FLOW",
  "FLUE",
  "FLUX",
  "FOAM",
  "FOCI",
  "FOES",
  "FOGS",
  "FOIL",
  "FOLD",
  "FOLK",
  "FOND",
  "FONT",
  "FOOD",
  "FOOL",
  "FOOT",
  "FORD",
  "FORE",
  "FORK",
  "FORM",
  "FORT",
  "FOUL",
  "FOUR",
  "FOWL",
  "FOXY",
  "FRAY",
  "FREE",
  "FRET",
  "FROG",
  "FROM",
  "FUEL",
  "FULL",
  "FUME",
  "FUND",
  "FUNK",
  "FURS",
  "FURY",
  "FUSE",
  "FUSS",
  "FUZZ",
  "GAGS",
  "GAIN",
  "GAIT",
  "GALE",
  "GALL",
  "GAME",
  "GANG",
  "GAPE",
  "GAPS",
  "GARB",
  "GASH",
  "GASP",
  "GATE",
  "GAVE",
  "GAWK",
  "GAZE",
  "GEAR",
  "GELS",
  "GEMS",
  "GENE",
  "GENT",
  "GERM",
  "GETS",
  "GIFT",
  "GIGS",
  "GILD",
  "GILT",
  "GIRL",
  "GIST",
  "GIVE",
  "GLAD",
  "GLAM",
  "GLEE",
  "GLEN",
  "GLIB",
  "GLOB",
  "GLOM",
  "GLOP",
  "GLOW",
  "GLUE",
  "GLUM",
  "GLUT",
  "GNAT",
  "GNAW",
  "GOAL",
  "GOAT",
  "GODS",
  "GOES",
  "GOLD",
  "GOLF",
  "GONE",
  "GONG",
  "GOOD",
  "GOOF",
  "GORE",
  "GORY",
  "GOSH",
  "GOTH",
  "GOWN",
  "GRAB",
  "GRAD",
  "GRAM",
  "GRAY",
  "GREW",
  "GREY",
  "GRID",
  "GRIM",
  "GRIN",
  "GRIP",
  "GRIT",
  "GROW",
  "GRUB",
  "GULF",
  "GULL",
  "GULP",
  "GUMS",
  "GUNK",
  "GUNS",
  "GURU",
  "GUSH",
  "GUST",
  "GUTS",
  "GUYS",
  "GYMS",
  "HACK",
  "HAIL",
  "HAIR",
  "HALE",
  "HALF",
  "HALL",
  "HALT",
  "HAMS",
  "HAND",
  "HANG",
  "HANK",
  "HAPS",
  "HARD",
  "HARE",
  "HARM",
  "HARP",
  "HASH",
  "HASP",
  "HAST",
  "HATE",
  "HATH",
  "HATS",
  "HAUL",
  "HAVE",
  "HAWK",
  "HAZE",
  "HAZY",
  "HEAD",
  "HEAL",
  "HEAP",
  "HEAR",
  "HEAT",
  "HECK",
  "HEED",
  "HEEL",
  "HEFT",
  "HEIR",
  "HELD",
  "HELL",
  "HELM",
  "HELP",
  "HEMP",
  "HENS",
  "HERB",
  "HERD",
  "HERE",
  "HERO",
  "HERS",
  "HIDE",
  "HIGH",
  "HIKE",
  "HILL",
  "HILT",
  "HIND",
  "HINT",
  "HIPS",
  "HIRE",
  "HITS",
  "HIVE",
  "HIYA",
  "HOAX",
  "HOBS",
  "HOCK",
  "HOED",
  "HOES",
  "HOGS",
  "HOLD",
  "HOLE",
  "HOLY",
  "HOME",
  "HONE",
  "HONK",
  "HOOD",
  "HOOF",
  "HOOK",
  "HOOP",
  "HOOT",
  "HOPE",
  "HOPS",
  "HORN",
  "HOSE",
  "HOST",
  "HOUR",
  "HOWL",
  "HUBS",
  "HUED",
  "HUES",
  "HUFF",
  "HUGE",
  "HUGS",
  "HULK",
  "HULL",
  "HUMP",
  "HUMS",
  "HUNG",
  "HUNK",
  "HUNT",
  "HURL",
  "HURT",
  "HUSH",
  "HUSK",
  "HUTS",
  "HYMN",
  "HYPE",
  "ICED",
  "ICES",
  "ICKY",
  "ICON",
  "IDEA",
  "IDLE",
  "IDLY",
  "IDOL",
  "IFFY",
  "ILLS",
  "INCA",
  "INCH",
  "INFO",
  "INKS",
  "INKY",
  "INNS",
  "INTO",
  "IONS",
  "IRIS",
  "IRKS",
  "IRON",
  "ISLE",
  "ITCH",
  "ITEM",
  "JABS",
  "JACK",
  "JADE",
  "JAIL",
  "JAMS",
  "JANE",
  "JARS",
  "JAVA",
  "JAWS",
  "JAZZ",
  "JEAN",
  "JEEP",
  "JEER",
  "JERK",
  "JEST",
  "JETS",
  "JIGS",
  "JILT",
  "JIVE",
  "JOBS",
  "JOCK",
  "JOGS",
  "JOIN",
  "JOKE",
  "JOLT",
  "JOSH",
  "JOTS",
  "JOWL",
  "JOYS",
  "JUDO",
  "JUGS",
  "JUMP",
  "JUNE",
  "JUNK",
  "JURY",
  "JUST",
  "KEEN",
  "KEEP",
  "KEGS",
  "KELP",
  "KEPT",
  "KEYS",
  "KICK",
  "KIDS",
  "KILL",
  "KILN",
  "KILT",
  "KIND",
  "KING",
  "KINK",
  "KISS",
  "KITE",
  "KITS",
  "KNEE",
  "KNEW",
  "KNIT",
  "KNOB",
  "KNOT",
  "KNOW",
  "LABS",
  "LACE",
  "LACK",
  "LACY",
  "LADS",
  "LADY",
  "LAGS",
  "LAID",
  "LAIR",
  "LAKE",
  "LAMB",
  "LAME",
  "LAMP",
  "LAND",
  "LANE",
  "LAPS",
  "LARD",
  "LARK",
  "LASH",
  "LASS",
  "LAST",
  "LATE",
  "LATH",
  "LAUD",
  "LAVA",
  "LAWN",
  "LAWS",
  "LAYS",
  "LAZY",
  "LEAD",
  "LEAF",
  "LEAK",
  "LEAN",
  "LEAP",
  "LEAS",
  "LEER",
  "LEFT",
  "LEGS",
  "LEND",
  "LENS",
  "LENT",
  "LESS",
  "LEST",
  "LEVY",
  "LIAR",
  "LICE",
  "LICK",
  "LIDS",
  "LIED",
  "LIEN",
  "LIES",
  "LIEU",
  "LIFE",
  "LIFT",
  "LIKE",
  "LILY",
  "LIMB",
  "LIME",
  "LIMP",
  "LINE",
  "LINK",
  "LINT",
  "LION",
  "LIPS",
  "LISP",
  "LIST",
  "LIVE",
  "LOAD",
  "LOAF",
  "LOAM",
  "LOAN",
  "LOBE",
  "LOBS",
  "LOCK",
  "LODE",
  "LOFT",
  "LOGE",
  "LOGO",
  "LOGS",
  "LONE",
  "LONG",
  "LOOK",
  "LOOM",
  "LOON",
  "LOOP",
  "LOOT",
  "LOPE",
  "LORD",
  "LORE",
  "LOSE",
  "LOSS",
  "LOST",
  "LOTS",
  "LOUD",
  "LOVE",
  "LOWS",
  "LUCK",
  "LUGE",
  "LUGS",
  "LULL",
  "LUMP",
  "LUNE",
  "LUNG",
  "LURE",
  "LURK",
  "LUSH",
  "LUST",
  "LUTE",
  "LYNX",
  "MACE",
  "MADE",
  "MADS",
  "MAID",
  "MAIL",
  "MAIM",
  "MAIN",
  "MAKE",
  "MALE",
  "MALL",
  "MALT",
  "MAMA",
  "MANE",
  "MANY",
  "MAPS",
  "MARE",
  "MARK",
  "MARS",
  "MART",
  "MASH",
  "MASK",
  "MASS",
  "MAST",
  "MATE",
  "MATH",
  "MATS",
  "MAUL",
  "MAZE",
  "MEAD",
  "MEAL",
  "MEAN",
  "MEAT",
  "MEEK",
  "MEET",
  "MELD",
  "MELT",
  "MEMO",
  "MEND",
  "MENU",
  "MEOW",
  "MERE",
  "MESH",
  "MESS",
  "MICE",
  "MILD",
  "MILE",
  "MILK",
  "MILL",
  "MIME",
  "MIND",
  "MINE",
  "MINI",
  "MINK",
  "MINT",
  "MINX",
  "MIRE",
  "MISS",
  "MIST",
  "MITE",
  "MITT",
  "MOAN",
  "MOAT",
  "MOBS",
  "MOCK",
  "MODE",
  "MOLD",
  "MOLE",
  "MOLT",
  "MONK",
  "MOOD",
  "MOON",
  "MOOR",
  "MOOT",
  "MOPE",
  "MOPS",
  "MORE",
  "MORN",
  "MOSS",
  "MOST",
  "MOTH",
  "MOVE",
  "MUCH",
  "MUCK",
  "MUDS",
  "MUFF",
  "MUGS",
  "MULE",
  "MULL",
  "MUMM",
  "MUMS",
  "MURK",
  "MUSE",
  "MUSH",
  "MUSK",
  "MUST",
  "MUTE",
  "MUTT",
  "MYTH",
  "NABS",
  "NAGS",
  "NAIL",
  "NAME",
  "NAPE",
  "NAPS",
  "NAVY",
  "NEAR",
  "NEAT",
  "NECK",
  "NEED",
  "NEON",
  "NERD",
  "NEST",
  "NETS",
  "NEWS",
  "NEWT",
  "NEXT",
  "NIBS",
  "NICE",
  "NICK",
  "NIGH",
  "NINE",
  "NIPS",
  "NITS",
  "NODE",
  "NODS",
  "NOEL",
  "NONE",
  "NOOK",
  "NOON",
  "NOPE",
  "NORM",
  "NOSE",
  "NOSY",
  "NOTE",
  "NOUN",
  "NOVA",
  "NUBS",
  "NUDE",
  "NULL",
  "NUMB",
  "NUNS",
  "NUTS",
  "OAFS",
  "OAKS",
  "OARS",
  "OATH",
  "OATS",
  "OBEY",
  "ODDS",
  "ODES",
  "ODOR",
  "OFFS",
  "OGRE",
  "OILS",
  "OILY",
  "OKAY",
  "OKRA",
  "OMEN",
  "OMIT",
  "ONCE",
  "ONES",
  "ONLY",
  "ONTO",
  "OOZE",
  "OOZY",
  "OPAL",
  "OPEN",
  "OPTS",
  "OPUS",
  "ORAL",
  "ORBS",
  "ORCA",
  "ORES",
  "OURS",
  "OUST",
  "OUTS",
  "OVAL",
  "OVEN",
  "OVER",
  "OWED",
  "OWES",
  "OWLS",
  "OWNS",
  "OXEN",
  "PACE",
  "PACK",
  "PACT",
  "PADS",
  "PAGE",
  "PAID",
  "PAIL",
  "PAIN",
  "PAIR",
  "PALE",
  "PALM",
  "PALS",
  "PANE",
  "PANG",
  "PANS",
  "PAPA",
  "PARE",
  "PARK",
  "PART",
  "PASS",
  "PAST",
  "PATH",
  "PATS",
  "PAVE",
  "PAWN",
  "PAWS",
  "PAYS",
  "PEAK",
  "PEAL",
  "PEAR",
  "PEAS",
  "PEAT",
  "PECK",
  "PECS",
  "PEEK",
  "PEEL",
  "PEEP",
  "PEER",
  "PEGS",
  "PELT",
  "PENS",
  "PENT",
  "PEON",
  "PEPS",
  "PERK",
  "PERM",
  "PERT",
  "PESO",
  "PEST",
  "PETS",
  "PEWS",
  "PICK",
  "PIED",
  "PIER",
  "PIES",
  "PIGS",
  "PIKE",
  "PILE",
  "PILL",
  "PIMP",
  "PINE",
  "PING",
  "PINK",
  "PINS",
  "PINT",
  "PIPE",
  "PIPS",
  "PISS",
  "PITA",
  "PITH",
  "PITS",
  "PITY",
  "PLAN",
  "PLAY",
  "PLEA",
  "PLEB",
  "PLED",
  "PLOD",
  "PLOP",
  "PLOT",
  "PLOW",
  "PLOY",
  "PLUG",
  "PLUM",
  "PLUS",
  "POCK",
  "PODS",
  "POEM",
  "POET",
  "POKE",
  "POKY",
  "POLE",
  "POLL",
  "POLO",
  "POMP",
  "POND",
  "PONY",
  "POOH",
  "POOL",
  "POOP",
  "POOR",
  "POPE",
  "POPS",
  "PORE",
  "PORK",
  "PORT",
  "POSE",
  "POSH",
  "POST",
  "POSY",
  "POTS",
  "POUR",
  "POUT",
  "PRAM",
  "PRAY",
  "PREP",
  "PREY",
  "PRIM",
  "PROD",
  "PROM",
  "PROP",
  "PROS",
  "PROW",
  "PUBS",
  "PUCK",
  "PUDS",
  "PUFF",
  "PUGS",
  "PUKE",
  "PULL",
  "PULP",
  "PUMA",
  "PUMP",
  "PUNS",
  "PUNK",
  "PUNS",
  "PUPA",
  "PUPS",
  "PURE",
  "PURR",
  "PUSH",
  "PUSS",
  "PUTS",
  "PUTT",
  "PUTZ",
  "QOPH",
  "QUAD",
  "QUAY",
  "QUIP",
  "QUIT",
  "QUIZ",
  "RACE",
  "RACK",
  "RACY",
  "RAFT",
  "RAGE",
  "RAGS",
  "RAID",
  "RAIL",
  "RAIN",
  "RAKE",
  "RAMP",
  "RAMS",
  "RANG",
  "RANK",
  "RANT",
  "RAPS",
  "RAPT",
  "RARE",
  "RASH",
  "RASP",
  "RATE",
  "RATS",
  "RAVE",
  "RAWS",
  "RAYS",
  "RAZE",
  "READ",
  "REAL",
  "REAM",
  "REAP",
  "REAR",
  "REDO",
  "REDS",
  "REED",
  "REEF",
  "REEK",
  "REEL",
  "REFS",
  "REIN",
  "RELY",
  "REND",
  "RENT",
  "REPO",
  "REPS",
  "REST",
  "REVS",
  "RIBS",
  "RICE",
  "RICH",
  "RIDE",
  "RIDS",
  "RIFE",
  "RIFF",
  "RIFT",
  "RIGS",
  "RILL",
  "RIME",
  "RIMS",
  "RIMY",
  "RIND",
  "RING",
  "RINK",
  "RIOT",
  "RIPE",
  "RIPS",
  "RISE",
  "RISK",
  "RITE",
  "ROAD",
  "ROAM",
  "ROAR",
  "ROBE",
  "ROBS",
  "ROCK",
  "RODE",
  "RODS",
  "ROLE",
  "ROLL",
  "ROMP",
  "ROOF",
  "ROOK",
  "ROOM",
  "ROOT",
  "ROPE",
  "ROPY",
  "ROSE",
  "ROSY",
  "ROTS",
  "ROUT",
  "ROVE",
  "ROWS",
  "RUBE",
  "RUBS",
  "RUBY",
  "RUCK",
  "RUDE",
  "RUED",
  "RUES",
  "RUFF",
  "RUGS",
  "RUIN",
  "RULE",
  "RUMP",
  "RUMS",
  "RUNG",
  "RUNS",
  "RUNT",
  "RUSE",
  "RUSH",
  "RUST",
  "RUTS",
  "SACK",
  "SAFE",
  "SAGA",
  "SAGE",
  "SAGS",
  "SAID",
  "SAIL",
  "SAKE",
  "SALE",
  "SALT",
  "SAME",
  "SAND",
  "SANE",
  "SANG",
  "SANK",
  "SAPS",
  "SARI",
  "SASH",
  "SASS",
  "SATE",
  "SAVE",
  "SAWS",
  "SAYS",
  "SCAB",
  "SCAM",
  "SCAN",
  "SCAR",
  "SCAT",
  "SEAL",
  "SEAM",
  "SEAR",
  "SEAS",
  "SEAT",
  "SECT",
  "SEED",
  "SEEK",
  "SEEM",
  "SEEN",
  "SEEP",
  "SEER",
  "SEES",
  "SELF",
  "SELL",
  "SEMI",
  "SEND",
  "SENT",
  "SEPT",
  "SERB",
  "SERF",
  "SETS",
  "SEWN",
  "SEWS",
  "SEXY",
  "SHAG",
  "SHAM",
  "SHAW",
  "SHED",
  "SHIM",
  "SHIN",
  "SHIP",
  "SHIV",
  "SHMO",
  "SHOD",
  "SHOE",
  "SHOO",
  "SHOP",
  "SHOT",
  "SHOW",
  "SHUN",
  "SHUT",
  "SICK",
  "SIDE",
  "SIFT",
  "SIGH",
  "SIGN",
  "SILK",
  "SILL",
  "SILO",
  "SILT",
  "SINE",
  "SING",
  "SINK",
  "SINS",
  "SIPS",
  "SIRE",
  "SIRS",
  "SITE",
  "SITS",
  "SIZE",
  "SKEW",
  "SKID",
  "SKIM",
  "SKIN",
  "SKIP",
  "SKIT",
  "SLAB",
  "SLAG",
  "SLAM",
  "SLAP",
  "SLAT",
  "SLAW",
  "SLAY",
  "SLED",
  "SLEW",
  "SLID",
  "SLIM",
  "SLIP",
  "SLIT",
  "SLOB",
  "SLOE",
  "SLOG",
  "SLOP",
  "SLOT",
  "SLOW",
  "SLUE",
  "SLUG",
  "SLUM",
  "SLUR",
  "SMOG",
  "SNAP",
  "SNAG",
  "SNIP",
  "SNIT",
  "SNOB",
  "SNOT",
  "SNOW",
  "SNUB",
  "SNUG",
  "SOAK",
  "SOAP",
  "SOAR",
  "SOBS",
  "SOCK",
  "SODA",
  "SODS",
  "SOFA",
  "SOFT",
  "SOIL",
  "SOLD",
  "SOLE",
  "SOLO",
  "SOME",
  "SONG",
  "SONS",
  "SOON",
  "SOOT",
  "SORE",
  "SORT",
  "SOUL",
  "SOUP",
  "SOUR",
  "SOWN",
  "SOWS",
  "SPAN",
  "SPAR",
  "SPAS",
  "SPAT",
  "SPEC",
  "SPED",
  "SPEW",
  "SPIN",
  "SPIT",
  "SPOT",
  "SPRY",
  "SPUD",
  "SPUN",
  "SPUR",
  "STAB",
  "STAG",
  "STAR",
  "STAT",
  "STAY",
  "STEM",
  "STEP",
  "STEW",
  "STIR",
  "STOP",
  "STOW",
  "STUB",
  "STUD",
  "STUN",
  "SUBS",
  "SUCH",
  "SUCK",
  "SUDS",
  "SUED",
  "SUES",
  "SUET",
  "SUIT",
  "SULK",
  "SUMO",
  "SUMP",
  "SUMS",
  "SUNG",
  "SUNK",
  "SUNS",
  "SUPS",
  "SURE",
  "SURF",
  "SUSS",
  "SWAB",
  "SWAG",
  "SWAM",
  "SWAN",
  "SWAP",
  "SWAT",
  "SWAY",
  "SWIM",
  "SWOP",
  "SYNC",
  "TABS",
  "TACK",
  "TACO",
  "TACT",
  "TADS",
  "TAGS",
  "TAIL",
  "TAKE",
  "TALE",
  "TALK",
  "TALL",
  "TAME",
  "TAMP",
  "TANS",
  "TAPE",
  "TAPS",
  "TARE",
  "TARN",
  "TARP",
  "TARS",
  "TART",
  "TASK",
  "TAUT",
  "TAXI",
  "TEAM",
  "TEAR",
  "TEAS",
  "TEAT",
  "TECH",
  "TEDS",
  "TEED",
  "TEEM",
  "TEEN",
  "TEES",
  "TELL",
  "TEMP",
  "TEND",
  "TENS",
  "TENT",
  "TERM",
  "TERN",
  "TEST",
  "TEXT",
  "THAN",
  "THAT",
  "THAW",
  "THEE",
  "THEM",
  "THEN",
  "THEW",
  "THEY",
  "THIN",
  "THIS",
  "THUD",
  "THUG",
  "THUS",
  "TICK",
  "TIDE",
  "TIDY",
  "TIED",
  "TIER",
  "TIES",
  "TIFF",
  "TILE",
  "TILL",
  "TILT",
  "TIME",
  "TINE",
  "TING",
  "TINS",
  "TINT",
  "TINY",
  "TIPS",
  "TIRE",
  "TOAD",
  "TOCK",
  "TODS",
  "TOED",
  "TOES",
  "TOFU",
  "TOGA",
  "TOGS",
  "TOIL",
  "TOLD",
  "TOLL",
  "TOMB",
  "TOME",
  "TONE",
  "TONG",
  "TONS",
  "TONY",
  "TOOK",
  "TOOL",
  "TOOT",
  "TOPS",
  "TORE",
  "TORN",
  "TORT",
  "TORY",
  "TOSS",
  "TOTE",
  "TOTS",
  "TOUR",
  "TOUT",
  "TOWN",
  "TOWS",
  "TOYS",
  "TRAM",
  "TRAP",
  "TRAY",
  "TREE",
  "TREK",
  "TRIM",
  "TRIO",
  "TRIP",
  "TROD",
  "TROT",
  "TRUE",
  "TSAR",
  "TUBA",
  "TUBE",
  "TUBS",
  "TUCK",
  "TUFT",
  "TUGS",
  "TUNA",
  "TUNE",
  "TURF",
  "TURN",
  "TUSH",
  "TUSK",
  "TUTU",
  "TWIG",
  "TWIN",
  "TWIT",
  "TWOS",
  "TYPE",
  "TYPO",
  "UGLY",
  "UNDO",
  "UNIT",
  "UNTO",
  "UPON",
  "URGE",
  "URNS",
  "USED",
  "USER",
  "USES",
  "VAIN",
  "VALE",
  "VAMP",
  "VANE",
  "VANS",
  "VARY",
  "VASE",
  "VAST",
  "VATS",
  "VEAL",
  "VEER",
  "VEIL",
  "VEIN",
  "VEND",
  "VENT",
  "VERB",
  "VERY",
  "VEST",
  "VETO",
  "VETS",
  "VIAL",
  "VICE",
  "VIED",
  "VIES",
  "VIEW",
  "VILE",
  "VINE",
  "VINO",
  "VIOL",
  "VISA",
  "VISE",
  "VOID",
  "VOLT",
  "VOTE",
  "VOWS",
  "WADE",
  "WADS",
  "WAFT",
  "WAGE",
  "WAGS",
  "WAIF",
  "WAIL",
  "WAIT",
  "WAKE",
  "WALK",
  "WALL",
  "WAND",
  "WANE",
  "WANT",
  "WARD",
  "WARE",
  "WARM",
  "WARN",
  "WARP",
  "WARS",
  "WART",
  "WARY",
  "WASH",
  "WASP",
  "WATT",
  "WAVE",
  "WAVY",
  "WAXY",
  "WAYS",
  "WEAK",
  "WEAN",
  "WEAR",
  "WEDS",
  "WEED",
  "WEEK",
  "WEEP",
  "WELD",
  "WELL",
  "WELT",
  "WEND",
  "WENT",
  "WEPT",
  "WERE",
  "WEST",
  "WETS",
  "WHAM",
  "WHAT",
  "WHEN",
  "WHET",
  "WHEW",
  "WHEY",
  "WHIM",
  "WHIP",
  "WHIR",
  "WHIZ",
  "WHOM",
  "WICK",
  "WIDE",
  "WIFE",
  "WIGS",
  "WILD",
  "WILE",
  "WILL",
  "WILT",
  "WILY",
  "WIMP",
  "WIND",
  "WINE",
  "WING",
  "WINK",
  "WINS",
  "WIPE",
  "WIRE",
  "WIRY",
  "WISE",
  "WISH",
  "WISP",
  "WITH",
  "WITS",
  "WOES",
  "WOKE",
  "WOKS",
  "WOLF",
  "WOMB",
  "WONS",
  "WOOD",
  "WOOF",
  "WOOL",
  "WOOS",
  "WORD",
  "WORE",
  "WORK",
  "WORM",
  "WORN",
  "WORT",
  "WOVE",
  "WRAP",
  "WREN",
  "WRIT",
  "YACK",
  "YAKS",
  "YAMS",
  "YANG",
  "YANK",
  "YAPS",
  "YARD",
  "YARN",
  "YAWL",
  "YAWN",
  "YAWS",
  "YEAR",
  "YEAS",
  "YELL",
  "YELP",
  "YENS",
  "YEPS",
  "YERK",
  "YEST",
  "YETI",
  "YEWS",
  "YIDS",
  "YINS",
  "YIPE",
  "YIPS",
  "YLEM",
  "YOBS",
  "YOCK",
  "YODS",
  "YOGA",
  "YOGI",
  "YOKE",
  "YOLK",
  "YORE",
  "YOUR",
  "YOWL",
  "YOWS",
  "YUAN",
  "YUCK",
  "YUKS",
  "YULE",
  "YUPS",
  "ZANY",
  "ZAPS",
  "ZEAL",
  "ZEBU",
  "ZEDS",
  "ZEES",
  "ZEKS",
  "ZERO",
  "ZEST",
  "ZETA",
  "ZINC",
  "ZINE",
  "ZING",
  "ZIPS",
  "ZITI",
  "ZITS",
  "ZONE",
  "ZONK",
  "ZOOM",
  "ZOOS",
]);

/**
 * Check if a word is valid for the word ladder game.
 * Validates against our word lists based on word length.
 */
function isValidWordLadderWord(word: string): boolean {
  const upperWord = word.toUpperCase();
  const length = upperWord.length;

  if (length === 3) {
    return VALID_THREE_LETTER_WORDS.has(upperWord);
  } else if (length === 4) {
    return VALID_FOUR_LETTER_WORDS.has(upperWord);
  } else if (length === 5) {
    return isValid5LetterWord(upperWord);
  }

  return false;
}

export function WordLadderGame({
  difficulty = "easy",
  onChangeDifficulty,
}: WordLadderGameProps) {
  const [puzzle, setPuzzle] = useState<WordLadderPuzzle | null>(null);
  const [ladder, setLadder] = useState<string[]>([]);
  const [currentInput, setCurrentInput] = useState("");
  const [gameOver, setGameOver] = useState(false);
  const [won, setWon] = useState(false);
  const [shake, setShake] = useState(false);
  const [errorMessage, setErrorMessage] = useState("");

  const wordLength = puzzle?.start.length || 5;

  const startNewGame = useCallback(() => {
    const newPuzzle = getRandomWordLadderPuzzle(difficulty);
    setPuzzle(newPuzzle);
    setLadder([newPuzzle.start]);
    setCurrentInput("");
    setGameOver(false);
    setWon(false);
    setErrorMessage("");
  }, [difficulty]);

  useEffect(() => {
    startNewGame();
  }, [startNewGame]);

  const submitWord = useCallback(() => {
    if (!puzzle) return;

    const word = currentInput.toUpperCase();

    // Check if word is the right length
    if (word.length !== wordLength) {
      setShake(true);
      setErrorMessage(`Word must be ${wordLength} letters`);
      setTimeout(() => {
        setShake(false);
        setErrorMessage("");
      }, 2000);
      return;
    }

    // Check if word is valid
    if (!isValidWordLadderWord(word)) {
      setShake(true);
      setErrorMessage("Not a valid word");
      setTimeout(() => {
        setShake(false);
        setErrorMessage("");
      }, 2000);
      return;
    }

    // Check if word differs by exactly one letter from the previous word
    const previousWord = ladder[ladder.length - 1];
    if (!differsByOneLetter(previousWord, word)) {
      setShake(true);
      setErrorMessage("Must change exactly one letter");
      setTimeout(() => {
        setShake(false);
        setErrorMessage("");
      }, 2000);
      return;
    }

    // Check if word is already in the ladder
    if (ladder.includes(word)) {
      setShake(true);
      setErrorMessage("Word already used");
      setTimeout(() => {
        setShake(false);
        setErrorMessage("");
      }, 2000);
      return;
    }

    // Add word to ladder
    const newLadder = [...ladder, word];
    setLadder(newLadder);
    setCurrentInput("");

    // Check if player reached the end word
    if (word === puzzle.end) {
      setWon(true);
      setGameOver(true);
    }
  }, [currentInput, puzzle, ladder, wordLength]);

  const handleKeyPress = useCallback(
    (key: string) => {
      if (gameOver) return;

      if (key === "ENTER") {
        submitWord();
      } else if (key === "BACKSPACE") {
        setCurrentInput((prev) => prev.slice(0, -1));
      } else if (
        key.length === 1 &&
        key.match(/[A-Z]/i) &&
        currentInput.length < wordLength
      ) {
        setCurrentInput((prev) => prev + key.toUpperCase());
      }
    },
    [gameOver, currentInput, wordLength, submitWord]
  );

  // Handle keyboard input
  useEffect(() => {
    const handleKeyDown = (e: KeyboardEvent) => {
      if (e.key === "Enter") {
        handleKeyPress("ENTER");
      } else if (e.key === "Backspace") {
        handleKeyPress("BACKSPACE");
      } else {
        handleKeyPress(e.key.toUpperCase());
      }
    };

    window.addEventListener("keydown", handleKeyDown);
    return () => window.removeEventListener("keydown", handleKeyDown);
  }, [handleKeyPress]);

  const keyboard = [
    ["Q", "W", "E", "R", "T", "Y", "U", "I", "O", "P"],
    ["A", "S", "D", "F", "G", "H", "J", "K", "L"],
    ["ENTER", "Z", "X", "C", "V", "B", "N", "M", "BACKSPACE"],
  ];

  if (!puzzle) {
    return (
      <Card className="p-6">
        <div className="text-center">Loading...</div>
      </Card>
    );
  }

  const moves = ladder.length - 1; // Don't count the starting word

  // Render a word in the ladder
  const renderWord = (
    word: string,
    isStart: boolean,
    isEnd: boolean,
    isCompleted: boolean
  ) => {
    return (
      <div className="flex justify-center gap-1">
        {word.split("").map((letter, i) => (
          <div
            key={i}
            className={`w-10 h-10 md:w-12 md:h-12 flex items-center justify-center text-xl font-bold rounded-lg border-2 transition-all
              ${isStart ? "bg-blue-500 text-white border-blue-600" : ""}
              ${isEnd && isCompleted ? "bg-green-500 text-white border-green-600" : ""}
              ${isEnd && !isCompleted ? "bg-slate-100 text-slate-400 border-slate-300" : ""}
              ${!isStart && !isEnd ? "bg-amber-100 text-amber-800 border-amber-300" : ""}
            `}
          >
            {letter}
          </div>
        ))}
      </div>
    );
  };

  // Render the input row
  const renderInputRow = () => {
    const letters = currentInput.split("");
    const cells = [];

    for (let i = 0; i < wordLength; i++) {
      cells.push(
        <div
          key={i}
          className={`w-10 h-10 md:w-12 md:h-12 flex items-center justify-center text-xl font-bold rounded-lg border-2 transition-all
            ${letters[i] ? "bg-white border-slate-400" : "bg-slate-50 border-slate-300"}
          `}
        >
          {letters[i] || ""}
        </div>
      );
    }

    return (
      <div className={`flex justify-center gap-1 ${shake ? "animate-shake" : ""}`}>
        {cells}
      </div>
    );
  };

  return (
    <Card className="p-6">
      <div className="text-center mb-4">
        <h2
          className="text-3xl font-black text-slate-800 mb-1"
          style={{
            fontFamily:
              "'Comic Sans MS', 'Chalkboard SE', 'Bradley Hand', cursive",
          }}
        >
          Word Ladder
        </h2>
        <p className="text-slate-600">
          Change one letter at a time to reach the goal!
        </p>
      </div>

      {/* Move Counter */}
      <div className="text-center mb-4">
        <span className="text-lg font-semibold text-slate-700">
          Moves: {moves} | Par: {puzzle.par}
        </span>
      </div>

      {/* Ladder Display */}
      <div className="flex flex-col items-center gap-2 mb-4">
        {/* Start word */}
        {renderWord(puzzle.start, true, false, false)}

        {/* Completed rungs (excluding start) */}
        {ladder.slice(1).map((word, index) => (
          <div key={index} className="flex flex-col items-center gap-2">
            <ArrowDown className="h-4 w-4 text-slate-400" />
            {renderWord(word, false, word === puzzle.end, word === puzzle.end)}
          </div>
        ))}

        {/* Current input (if game not over) */}
        {!gameOver && (
          <>
            <ArrowDown className="h-4 w-4 text-slate-400" />
            {renderInputRow()}
          </>
        )}

        {/* Target word (if not yet reached) */}
        {!won && (
          <>
            <div className="flex flex-col items-center py-2">
              <span className="text-xs text-slate-400 mb-1">...</span>
              <ArrowDown className="h-4 w-4 text-slate-400" />
            </div>
            {renderWord(puzzle.end, false, true, false)}
          </>
        )}
      </div>

      {/* Error Message */}
      {errorMessage && (
        <div className="text-center mb-4">
          <p className="text-amber-600 font-medium text-lg animate-pulse">
            {errorMessage}
          </p>
        </div>
      )}

      {/* Game Over Message */}
      {gameOver && (
        <div className="text-center mb-6">
          {won && (
            <div className="flex flex-col items-center gap-2 mb-4">
              <div className="flex items-center gap-2 text-green-600">
                <Trophy className="h-8 w-8" />
                <span className="text-2xl font-bold">You Made It!</span>
              </div>
              <p className="text-slate-600">
                {moves <= puzzle.par ? (
                  <span className="text-green-600 font-semibold">
                    Amazing! You did it in {moves} moves (par: {puzzle.par})!
                  </span>
                ) : (
                  <span>
                    Completed in {moves} moves (par: {puzzle.par})
                  </span>
                )}
              </p>
            </div>
          )}
          <Button
            onClick={startNewGame}
            className="min-h-[48px] bg-gradient-to-r from-green-500 to-emerald-500"
          >
            <RefreshCw className="h-5 w-5 mr-2" />
            Play Again
          </Button>
        </div>
      )}

      {/* Keyboard */}
      {!gameOver && (
        <div className="flex flex-col items-center gap-2">
          {keyboard.map((row, rowIndex) => (
            <div key={rowIndex} className="flex gap-1">
              {row.map((key) => {
                const isSpecial = key === "ENTER" || key === "BACKSPACE";
                return (
                  <button
                    key={key}
                    onClick={() => handleKeyPress(key)}
                    className={`${isSpecial ? "px-3 md:px-4" : "w-8 md:w-10"} h-12 md:h-14 rounded-lg font-bold text-sm md:text-base transition-all active:scale-95 bg-slate-200 hover:bg-slate-300`}
                  >
                    {key === "BACKSPACE" ? "\u232B" : key}
                  </button>
                );
              })}
            </div>
          ))}
        </div>
      )}

      {/* Change Difficulty */}
      {onChangeDifficulty && (
        <div className="flex justify-center mt-6">
          <button
            onClick={onChangeDifficulty}
            className="flex items-center gap-2 text-slate-500 hover:text-slate-700 text-sm transition-colors"
          >
            <Settings className="h-4 w-4" />
            Change Difficulty
          </button>
        </div>
      )}

      <style jsx global>{`
        @keyframes shake {
          0%,
          100% {
            transform: translateX(0);
          }
          25% {
            transform: translateX(-5px);
          }
          75% {
            transform: translateX(5px);
          }
        }
        .animate-shake {
          animation: shake 0.3s ease-in-out;
        }
      `}</style>
    </Card>
  );
}
